<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‚úñÔ∏è Multiplication Adventure</title>
<style>
body { margin:0; overflow:hidden; font-family:Comic Sans MS, cursive; background:#111; }
#questionBox {
  position:absolute; top:20px; left:50%; transform:translateX(-50%);
  background:rgba(255,255,255,0.95); padding:20px; border-radius:10px; text-align:center;
  display:none; z-index:20;
}
#questionBox h2 { margin:0 0 10px; color:#333; }
#answerInput { font-size:1.2em; padding:5px; width:100px; text-align:center; }
#submitBtn, #restartBtn {
  font-size:1em; padding:8px 15px; margin:8px; border:none; border-radius:5px; cursor:pointer;
  background:#00cc66; color:#fff;
}
#restartBtn { position:absolute; top:20px; right:20px; background:#ff6600; z-index:20; }
canvas { display:block; z-index:1; position:relative; }
</style>
</head>
<body>

<div id="questionBox">
  <h2 id="questionText"></h2>
  <input type="text" id="answerInput" placeholder="Answer">
  <button id="submitBtn">Submit</button>
  <div id="feedback"></div>
</div>
<button id="restartBtn">üîÑ Restart</button>

<audio id="applauseSound" src="https://cdn.pixabay.com/download/audio/2021/09/15/audio_21b1dd5c93.mp3?filename=applause-weak-01-116117.mp3"></audio>

<script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
<script>
let scene, camera, renderer, player, barriers=[];
let currentBarrier=0;
let questions=[], answers=[];
let speed=0.15, pathPoints=[], particles=[], fireworksActive=false;

const successMessages=[
  "üåü Great job!", "üî• You rock!", "üéâ Keep going!",
  "üí° Smart thinking!", "üöÄ Awesome!", "üëè Brilliant!", "‚ú® Fantastic!"
];

// ---------- Initialize Scene ----------
function initScene(){
  scene = new THREE.Scene();
  scene.background = new THREE.Color(0x88ccff);

  camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
  camera.position.set(0,5,10);
  camera.lookAt(0,1.5,0);

  renderer = new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);

  const dirLight = new THREE.DirectionalLight(0xffffff,1);
  dirLight.position.set(10,20,10);
  scene.add(dirLight);
  const ambLight = new THREE.AmbientLight(0xffffff,0.7);
  scene.add(ambLight);

  const ground = new THREE.Mesh(
    new THREE.PlaneGeometry(400,400),
    new THREE.MeshPhongMaterial({color:0x228822})
  );
  ground.rotation.x = -Math.PI/2;
  scene.add(ground);

  // Player = 3D ball
  const loader = new THREE.TextureLoader();
  loader.load("https://i.imgur.com/WtI9H5X.jpg", function(texture){
    const geometry = new THREE.SphereGeometry(1.2,32,32);
    const material = new THREE.MeshPhongMaterial({map:texture});
    player = new THREE.Mesh(geometry, material);
    player.position.set(0,1.5,2);
    scene.add(player);
  });

  createZigzagPath();
  generateQuestions();
}

// ---------- Path & Barriers ----------
function createZigzagPath(){
  barriers.forEach(b=>scene.remove(b));
  barriers=[]; pathPoints=[];
  const pathMat = new THREE.MeshPhongMaterial({color:0x888888});
  let x=0, z=0, dir="z";
  for(let i=0;i<10;i++){
    if(dir==="z"){ z-=12; dir="x"; } else { x+=(i%2===0?12:-12); dir="z"; }
    pathPoints.push({x,z});
    const block = new THREE.Mesh(new THREE.BoxGeometry(6,0.5,6), pathMat);
    block.position.set(x,0.25,z); scene.add(block);
    const barrierMat = new THREE.MeshPhongMaterial({color:0xff0000});
    const barrier = new THREE.Mesh(new THREE.BoxGeometry(4,3,0.5), barrierMat);
    barrier.position.set(x,1.5,z); scene.add(barrier); barriers.push(barrier);
  }
}

// ---------- Generate Multiplication Questions ----------
function generateQuestions(){
  questions=[]; answers=[];
  for(let i=0;i<10;i++){
    let a = Math.floor(Math.random()*12)+1; // 1-12 multiplication table
    let b = Math.floor(Math.random()*12)+1;
    questions.push(`${a} √ó ${b}`);
    answers.push(a*b);
  }
}

// ---------- Show Question ----------
function showQuestion(){
  const box=document.getElementById("questionBox");
  box.style.display="block";
  document.getElementById("questionText").textContent=`Barrier ${currentBarrier+1}: Solve ${questions[currentBarrier]}`;
  document.getElementById("answerInput").value="";
  document.getElementById("feedback").textContent="";
  document.getElementById("answerInput").focus();
}

// ---------- Check Answer ----------
function checkAnswer(){
  const val=parseInt(document.getElementById("answerInput").value);
  if(val===answers[currentBarrier]){
    document.getElementById("feedback").textContent = successMessages[Math.floor(Math.random()*successMessages.length)];
    scene.remove(barriers[currentBarrier]);
    currentBarrier++;
    setTimeout(()=>{document.getElementById("questionBox").style.display="none"; if(currentBarrier===barriers.length) triggerCelebration();},800);
  } else {
    document.getElementById("feedback").textContent="‚ùå Oops, try again!";
  }
}

// ---------- Celebration ----------
function triggerCelebration(){
  fireworksActive=true;
  document.getElementById("applauseSound").play();
  for(let i=0;i<200;i++){
    const geo=new THREE.SphereGeometry(0.1,8,8);
    const mat=new THREE.MeshPhongMaterial({color:Math.random()*0xffffff});
    const particle=new THREE.Mesh(geo,mat);
    particle.position.set(player.position.x,player.position.y+2,player.position.z);
    particle.velocity={x:(Math.random()-0.5)*0.8,y:Math.random()*0.8,z:(Math.random()-0.5)*0.8};
    particles.push(particle); scene.add(particle);
  }
}

// ---------- Animation Loop ----------
function animate(){
  requestAnimationFrame(animate);
  if(player && currentBarrier<barriers.length){
    const target=pathPoints[currentBarrier]; if(!target) return;
    const dx=target.x-player.position.x;
    const dz=target.z-player.position.z;
    const dist=Math.sqrt(dx*dx+dz*dz);
    if(dist>0.2){
      player.position.x+=(dx/dist)*speed; player.position.z+=(dz/dist)*speed;
      camera.position.x+=(dx/dist)*speed; camera.position.z+=(dz/dist)*speed;
    } else if(document.getElementById("questionBox").style.display==="none"){
      showQuestion();
    }
  }
  if(fireworksActive) particles.forEach(p=>{ p.position.x+=p.velocity.x; p.position.y+=p.velocity.y; p.position.z+=p.velocity.z; p.velocity.y-=0.01; });
  renderer.render(scene,camera);
}

// ---------- Restart ----------
function restartGame(){
  currentBarrier=0;
  if(player) player.position.set(0,1.5,2);
  camera.position.set(0,5,10);
  generateQuestions();
  createZigzagPath();
  document.getElementById("questionBox").style.display="none";
  particles.forEach(p=>scene.remove(p));
  particles=[]; fireworksActive=false;
}

// ---------- Event Listeners ----------
document.getElementById("submitBtn").onclick=checkAnswer;
document.getElementById("restartBtn").onclick=restartGame;
document.getElementById("answerInput").addEventListener("keydown",e=>{ if(e.key==="Enter") checkAnswer(); });

// ---------- Start Game ----------
initScene();
animate();
</script>

</body>
</html>


